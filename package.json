{
  "name": "whpcodes",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "PORT=3000 node scripts/set-env-from-branch.js && npm run build:proofs && npm run build:verifyjson && next dev -p 3000",
    "start:local-prod": "node scripts/set-env-from-branch.js --force-production && next dev",
    "start:local-backup": "node scripts/set-env-from-branch.js --force-backup && next dev",
    "scrub:backup": "node golden-scripts/GOLDEN-SCRUB-PROMO-DESCRIPTIONS.mjs",
    "scrub:prod:dry": "DATABASE_URL=$TARGET_DATABASE_URL node golden-scripts/GOLDEN-SCRUB-PROMO-DESCRIPTIONS.mjs --dry",
    "scrub:prod": "DATABASE_URL=$TARGET_DATABASE_URL node golden-scripts/GOLDEN-SCRUB-PROMO-DESCRIPTIONS.mjs",
    "scrub:titles:backup": "node golden-scripts/GOLDEN-SCRUB-PROMO-TITLES.mjs",
    "scrub:titles:prod:dry": "DATABASE_URL=$TARGET_DATABASE_URL node golden-scripts/GOLDEN-SCRUB-PROMO-TITLES.mjs --dry",
    "scrub:titles:prod": "DATABASE_URL=$TARGET_DATABASE_URL node golden-scripts/GOLDEN-SCRUB-PROMO-TITLES.mjs",
    "dedupe:backup:dry": "node golden-scripts/GOLDEN-DEDUPE-PROMOCODES-CASEFOLD.mjs --dry",
    "dedupe:backup": "node golden-scripts/GOLDEN-DEDUPE-PROMOCODES-CASEFOLD.mjs",
    "dedupe:prod:dry": "DATABASE_URL=$TARGET_DATABASE_URL node golden-scripts/GOLDEN-DEDUPE-PROMOCODES-CASEFOLD.mjs --dry",
    "dedupe:prod": "DATABASE_URL=$TARGET_DATABASE_URL node golden-scripts/GOLDEN-DEDUPE-PROMOCODES-CASEFOLD.mjs",
    "titles:fix:backup": ". .env.sync && psql \"$SOURCE_DATABASE_URL\" -v ON_ERROR_STOP=1 -f golden-scripts/GOLDEN-FIX-TITLE-FORMAT.sql",
    "titles:fix:prod": ". .env.sync && psql \"$TARGET_DATABASE_URL\" -v ON_ERROR_STOP=1 -f golden-scripts/GOLDEN-FIX-TITLE-FORMAT.sql",
    "titles:verify:backup": ". .env.sync && psql \"$SOURCE_DATABASE_URL\" -v ON_ERROR_STOP=1 -f golden-scripts/GOLDEN-VERIFY-TITLE-CODE-CONSISTENCY.sql",
    "titles:verify:prod": ". .env.sync && psql \"$TARGET_DATABASE_URL\" -v ON_ERROR_STOP=1 -f golden-scripts/GOLDEN-VERIFY-TITLE-CODE-CONSISTENCY.sql",
    "dev:seo": "ts-node --transpile-only scripts/build-seo-indexes.ts && next dev",
    "build:proofs": "NODE_OPTIONS='-r tsconfig-paths/register' tsx scripts/build-proof-manifest.ts",
    "build:verifyjson": "NODE_OPTIONS='-r tsconfig-paths/register' tsx scripts/copy-verification-to-public.ts",
    "build:graph": "ts-node --transpile-only scripts/build-graph.ts",
    "build:graph-optimized": "ts-node --transpile-only scripts/build-graph-optimized.ts",
    "build:graph-chatgpt": "ts-node --transpile-only scripts/build-graph-chatgpt.ts",
    "graph:publish": "ts-node --transpile-only scripts/build-and-publish-graph.ts",
    "graph:publish-optimized": "ts-node --transpile-only scripts/build-and-publish-graph-optimized.ts",
    "fix:beforecents": "tsx --tsconfig tsconfig.cjs.json scripts/fix-beforecents.ts --write",
    "prebuild": "test \"$SKIP_SEO_BUILD\" = \"1\" && echo '⏭️  Skipping SEO builds (SKIP_SEO_BUILD=1)' || (tsx scripts/build-seo-indexes.ts && tsx scripts/build-sitemaps.ts)",
    "prebuild:with-graph": "ts-node --transpile-only scripts/build-seo-indexes.ts && ts-node --transpile-only scripts/build-sitemaps.ts && npm run build:graph",
    "prebuild:guard": "test ! -f public/sitemap.xml || (echo '❌ Remove public/sitemap.xml; /sitemap.xml is served by app route' && exit 1) && test ! -f public/robots.txt || (echo '❌ Remove public/robots.txt; /robots.txt is served by app route' && exit 1)",
    "build": "npm run prebuild:guard && npm run fix:beforecents && npm run build:proofs && npm run build:verifyjson && npm run schema:guard && next build",
    "build:migrate": "prisma migrate deploy && npm run fix:beforecents && npm run build:proofs && npm run build:verifyjson && next build",
    "build:dev": "next build",
    "start": "next start",
    "test:local:prod": "rm -rf .next && NODE_ENV=production npm run build && NODE_ENV=production npm start",
    "smoke": "node scripts/smoke-test.mjs",
    "lint": "next lint",
    "lint:seo": "node scripts/check-seo-pages.mjs",
    "assert:seo": "node scripts/assert-seo-build.mjs",
    "build:strict": "npm run lint:seo && npm run build",
    "build:guarded": "npm run build && npm run assert:seo",
    "warm:whops": "node scripts/warm-top-whops.mjs",
    "schema:guard": "NODE_OPTIONS='-r ./scripts/shims/next-build-shims.cjs -r tsconfig-paths/register' tsx scripts/schema-guard.ts",
    "typecheck": "tsc --noEmit",
    "prepush": "npm run typecheck",
    "test": "playwright test",
    "test:headed": "playwright test --headed",
    "test:seo": "playwright test tests/seo.spec.ts",
    "postinstall": "prisma generate",
    "db:check-safety": "node scripts/database-safety-guard.js",
    "db:push": "node scripts/database-safety-guard.js 'npx prisma db push' && npx prisma db push",
    "db:migrate": "node scripts/database-safety-guard.js 'npx prisma migrate dev' && npx prisma migrate dev",
    "sync:promos:dry": "node golden-scripts/GOLDEN-SAFE-PROMO-SYNC-BY-SLUG.mjs --dry",
    "sync:promos": "node golden-scripts/GOLDEN-SAFE-PROMO-SYNC-BY-SLUG.mjs",
    "db:check:dupes:backup": ". .env.sync && psql \"$SOURCE_DATABASE_URL\" -c \"SELECT COUNT(*) as duplicate_groups FROM (SELECT \\\"whopId\\\",\\\"code\\\", COUNT(*) FROM \\\"PromoCode\\\" GROUP BY 1,2 HAVING COUNT(*) > 1) x;\"",
    "db:check:dupes:prod": ". .env.sync && psql \"$TARGET_DATABASE_URL\" -c \"SELECT COUNT(*) as duplicate_groups FROM (SELECT \\\"whopId\\\",\\\"code\\\", COUNT(*) FROM \\\"PromoCode\\\" GROUP BY 1,2 HAVING COUNT(*) > 1) x;\"",
    "seo:backfill-retirement": "ts-node --transpile-only scripts/backfill-retirement.ts",
    "seo:build-indexes": "ts-node --transpile-only scripts/build-seo-indexes.ts",
    "db:seed": "ts-node prisma/seed.ts",
    "fix-prices": "ts-node scripts/fix-prices.ts",
    "fix-prices:apply": "ts-node scripts/fix-prices.ts --apply",
    "check-suspicious-prices": "ts-node scripts/check-suspicious-prices.ts",
    "fix-name-prices": "ts-node scripts/fix-name-based-prices.ts",
    "fix-name-prices:apply": "ts-node scripts/fix-name-based-prices.ts --apply",
    "fix-specific-courses": "ts-node scripts/fix-specific-courses.ts",
    "fix-specific-courses:apply": "ts-node scripts/fix-specific-courses.ts --apply",
    "normalize-prices": "ts-node scripts/normalize-prices.ts",
    "normalize-prices:apply": "ts-node scripts/normalize-prices.ts --apply",
    "categorize-whops": "ts-node scripts/categorize-all-whops.ts",
    "categorize-whops:apply": "ts-node scripts/categorize-all-whops.ts --apply",
    "categorize-whops-holistic": "ts-node scripts/categorize-all-whops-holistic.ts",
    "categorize-whops-holistic:apply": "ts-node scripts/categorize-all-whops-holistic.ts --apply",
    "check-affiliate-links": "node scripts/check-current-affiliate-links.js",
    "update-affiliate-links": "node scripts/update-whop-affiliate-links.js",
    "import-csv": "node scripts/import-and-fix-csv.js",
    "publish-whops": "ts-node scripts/manual-publish-whops.ts",
    "check-whop-status": "ts-node scripts/check-whop-status.ts",
    "publish-custom": "ts-node scripts/publish-custom-whops.ts",
    "freshness:check": "node scripts/auto-check-whops.mjs",
    "freshness:sync": "ts-node --transpile-only scripts/freshness-sync.ts",
    "verify:promo-codes": "ts-node --transpile-only scripts/verify-promo-codes.ts",
    "freshness:real": "ts-node --transpile-only scripts/add-real-discount-data.ts",
    "sitemap:build": "ts-node --transpile-only scripts/build-sitemaps.ts",
    "freshness:real+site": "npm run freshness:real && npm run sitemap:build",
    "sync:whpcodes": "node src/sync-ledgers-from-whpcodes.mjs",
    "content:convert": "node scripts/convert-neon-export.mjs",
    "content:jsonify": "node scripts/content-json-array-to-jsonl.mjs",
    "content:csv": "node scripts/validate-and-csv.mjs",
    "content:build": "npm run content:jsonify && npm run content:csv",
    "content:import:backup": "psql \"$SOURCE_DATABASE_URL\" -v ON_ERROR_STOP=1 -f golden-scripts/GOLDEN-IMPORT-WHOP-CONTENT.sql",
    "content:import:prod": "psql \"$TARGET_DATABASE_URL\" -v ON_ERROR_STOP=1 -f golden-scripts/GOLDEN-IMPORT-WHOP-CONTENT.sql",
    "content:monitor": "node scripts/monitor-whop-progress.mjs --provider=openai --target=8500 --budget=50",
    "content:check": "node scripts/check-jsonl.mjs --in=data/neon/whops.jsonl",
    "content:prep": "npm run content:convert -- --in=data/neon/whops.json && npm run content:check"
  },
  "prisma": {
    "schema": "prisma/schema.prisma",
    "seed": "ts-node prisma/seed.ts"
  },
  "dependencies": {
    "@auth/prisma-adapter": "^2.9.1",
    "@hookform/resolvers": "^5.0.1",
    "@next-auth/prisma-adapter": "^1.0.7",
    "@prisma/client": "^5.10.0",
    "@types/nodemailer": "^6.4.17",
    "@types/uuid": "^10.0.0",
    "csv-parse": "^5.6.0",
    "dotenv": "^17.2.0",
    "googleapis": "^153.0.0",
    "isomorphic-dompurify": "^2.26.0",
    "jsonwebtoken": "^9.0.2",
    "next": "14.2.13",
    "next-auth": "^4.24.11",
    "node-fetch": "^3.3.2",
    "nodemailer": "^6.10.1",
    "playwright": "^1.55.0",
    "react": "18.3.1",
    "react-beautiful-dnd": "^13.1.1",
    "react-dom": "18.3.1",
    "react-hook-form": "^7.56.1",
    "react-hot-toast": "^2.5.2",
    "react-markdown": "^10.1.0",
    "react-quill": "^2.0.0",
    "recharts": "^2.15.3",
    "resend": "^4.6.0",
    "seedrandom": "^3.0.5",
    "uuid": "^11.1.0",
    "xml2js": "^0.6.2",
    "zod": "^3.24.3"
  },
  "devDependencies": {
    "@playwright/test": "^1.54.2",
    "@types/bcryptjs": "^2.4.6",
    "@types/jsonwebtoken": "^9.0.9",
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-beautiful-dnd": "^13.1.8",
    "@types/react-dom": "^18",
    "@types/seedrandom": "^3.0.8",
    "autoprefixer": "^10.0.1",
    "bcryptjs": "^3.0.2",
    "eslint": "^8",
    "eslint-config-next": "14.2.3",
    "postcss": "^8",
    "prisma": "^5.10.0",
    "server-only": "^0.0.1",
    "tailwindcss": "^3.3.0",
    "ts-node": "^10.9.1",
    "tsconfig-paths": "^4.2.0",
    "tsx": "^4.20.6",
    "typescript": "^5"
  }
}
